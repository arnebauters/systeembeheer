<IfModule mod_ssl.c>
<VirtualHost _default_:443>
        ServerAdmin webmaster@localhost

	DocumentRoot /var/ntop/www
	ScriptAlias /ntop-bin/ /var/ntop/ntop-bin/
	ScriptAlias /api-bin/ /var/ntop/api-bin/
	ScriptAlias /nxn-bin/ /var/ntop/nxn-bin/
	#AddRadiusAuth

	<Directory />
        	Options FollowSymLinks
        	 AllowOverride AuthConfig
	</Directory>

        <Directory /var/ntop/www/nxn/>
                Options FollowSymLinks
                 AllowOverride AuthConfig
        </Directory>

        <Directory /var/ntop/www/>
                Options Indexes FollowSymLinks MultiViews
                AllowOverride None
                Require all granted
        </Directory>

        ErrorLog ${APACHE_LOG_DIR}/nbox-ssl_error.log

        # Possible values include: debug, info, notice, warn, error, crit,
        # alert, emerg.
        LogLevel warn

        CustomLog ${APACHE_LOG_DIR}/nbox-ssl_access.log combined

        SSLEngine on

        SSLCertificateFile    /etc/ssl/certs/nbox.crt
        SSLCertificateKeyFile /etc/ssl/private/nbox.key

        SSLProtocol all -SSLv2 -SSLv3
        SSLHonorCipherOrder on
        SSLInsecureRenegotiation off

        SSLCipherSuite "ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES256-SHA256:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256"

        #     directives are used in per-directory context.
        #SSLOptions +FakeBasicAuth +ExportCertData +StrictRequire
        <FilesMatch "\.(cgi|shtml|phtml|php)$">
                SSLOptions +StdEnvVars
        </FilesMatch>
        BrowserMatch "MSIE [2-6]" \
                nokeepalive ssl-unclean-shutdown \
                downgrade-1.0 force-response-1.0
        # MSIE 7 and newer should be able to use keepalive
        BrowserMatch "MSIE [17-9]" ssl-unclean-shutdown

</VirtualHost>
</IfModule>

